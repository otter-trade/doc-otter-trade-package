import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,a as n}from"./app--3yBhCc0.js";const t="/assets/coin-candle.drawio-Cw_Jxe-l.svg",l="/assets/fetch-log-CD9x-NWE.png",h={},k=n(`<h1 id="_1-市场模块coin-candle" tabindex="-1"><a class="header-anchor" href="#_1-市场模块coin-candle"><span>1. 市场模块<code>coin-candle</code></span></a></h1><p>仓库地址: <a href="https://github.com/otter-trade/coin-candle" target="_blank" rel="noopener noreferrer">https://github.com/otter-trade/coin-candle</a></p><p>要解决的问题：</p><ol><li>国内获取数据需要<code>科学上网</code></li><li>交易所请求规范和行为不统一，解析方式也不统一，请求参数也比较繁琐</li><li>回测时对 K 线的消耗比较大，但是频繁去交易所获取效率太慢</li><li>需要用到 K 线模块的服务太多了</li></ol><blockquote><p>其实团队内小伙伴写了一个版本的市场 K 线服务，但并不满意，于是花了一个周末的时间重新肝了一个版本。</p></blockquote><h2 id="安装方式" tabindex="-1"><a class="header-anchor" href="#安装方式"><span>安装方式</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> github.com/otter-trade/coin-candle</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="代码示例" tabindex="-1"><a class="header-anchor" href="#代码示例"><span>代码示例</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="main.go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">fmt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">time</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/handy-golang/go-tools/m_cycle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/handy-golang/go-tools/m_time</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/otter-trade/coin-candle/exchange_api</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#98C379;">github.com/otter-trade/coin-candle/global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// 初始化项目配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SysInit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">SysInitOpt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		LogPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:   </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 日志文件存放目录，缺省值：./logs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		DataPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 数据文件存放目录，缺省值：./data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		ProxyURLs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: []</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://127.0.0.1:10809&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 在拉取交易所数据时使用的代理池,没有代理则直接向交易所发起请求，国内可能会失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// 启动一个定时器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	m_cycle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">New</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">m_cycle</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Opt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		Func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">			exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">UpdateLocalGoodsList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 更新商品列表至本地</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">			exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">UpdateLocalTicker</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()    </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 更新榜单数据至本地</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">		},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		SleepTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Hour</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 每4小时执行一次更新</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	}).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Start</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// ####### 获取商品列表的方法 #######</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	GoodsList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetGoodsList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;获取商品列表失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;GoodsList 商品总数:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">GoodsList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// ####### 获取单个商品的详情 #######</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	GoodsDetail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetGoodsDetail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">GetGoodsDetailOpt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		GoodsId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;BTC-USDT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;获取商品详情失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;GoodsDetail 最后更新时间&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">GoodsDetail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">GoodsId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">GoodsDetail</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">UpdateStr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// ####### 获取榜单数据  #######</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	TickerList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetTickerList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;获取榜单数据失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;TickerList 今日上榜币种数量:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">TickerList</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// ####### 任意时间点和任意币种的 K线数据获取 #######</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m_time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetUnixInt64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// time := m_time.TimeParse(m_time.LaySP_ss, &quot;2023-05-06 18:56:43&quot;)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	time</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m_time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TimeParse</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">m_time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">LaySP_ss</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;2024-05-21 18:55:43&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	// time := m_time.GetUnixInt64()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	klineMap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> exchange_api</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetKline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">GetKlineOpt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		GoodsId</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;BTC-USDT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		Bar</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:      </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;1m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 允许值 1m  5m  15m  30m  1h</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		EndTime</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                       </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//13 位毫秒时间戳</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		Limit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:    </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">320</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                        </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 1-500 的正整数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		Exchange</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: []</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;okx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;binance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 需要请求的交易所， 目前只支持 okx 和 binance</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> m_time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">GetUnixInt64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> diff</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> endTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> startTime</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;diff:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> err</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> !=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">		fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;获取K线数据失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;kline 总长度&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">klineMap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;binance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装依赖，创建文件，然后 执行 <code>go mod tidy</code> 和 <code>go run main.go</code> 查看打印结果</p><h2 id="数据结构示意" tabindex="-1"><a class="header-anchor" href="#数据结构示意"><span>数据结构示意</span></a></h2><p><strong>商品信息数据结构</strong></p><blockquote><p>这里综合了 <a href="https://www.binance.com" target="_blank" rel="noopener noreferrer">币安</a>、<a href="https://www.okx.com" target="_blank" rel="noopener noreferrer">欧意</a>，两个交易所的公共货币，也就是说该列表的任意货币都可以在 两大交易所随时进行交易，当 <code>State</code> 不为 <code>live</code> 时，说明该币种在其中一个交易所的状态出现了问题。</p></blockquote><p>更新频率可以在程序初始化时自定，哪怕一分钟更新一次都没问题。</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> GoodsType</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	GoodsId</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            \`json:&quot;GoodsId&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // OtterTrade 的交易品ID 以 OKX 为准 如 BTC-USDT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	State</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">         string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            \`json:&quot;State&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">         // 交易品现货状态，默认；live OKX 现货，币安 现货 ，OKX 合约 有一家状态不对 则为 warning</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	UpdateUnix</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    int64</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             \`json:&quot;UpdateUnix&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // 更新时间戳</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	UpdateStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            \`json:&quot;UpdateStr&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 更新时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	QuoteCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            \`json:&quot;QuoteCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // 计价货币 如 USDT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BaseCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            \`json:&quot;BaseCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // 基础货币 如 BTC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Okx_SPOT_Info</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> OkxInstType</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       \`json:&quot;Okx_SPOT_Info&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 欧意交易所 现货 的完整产品信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Okx_SWAP_Info</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> OkxInstType</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       \`json:&quot;Okx_SWAP_Info&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 欧意交易所 合约 的完整产品信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BinanceInfo</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">   BinanceSymbolType</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;BinanceInfo&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   // 币安交易所的完整产品信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> OkxInstType</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BaseCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;baseCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // 交易货币币种，如 BTC-USDT 中的 BTC ，仅适用于币币/币币杠杆</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	CtMult</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;ctMult&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // 合约乘数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	CtType</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;ctType&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // 合约类型  linear：正向合约  inverse：反向合约</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	CtVal</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;ctVal&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 合约面值 如: 一个合约 0.01 个 BTC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	CtValCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;ctValCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 合约面值计价币种 如 BTC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	ExpTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;expTime&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // 下架时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	InstFamily</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">   string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;instFamily&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">   // 交易品种，如 BTC-USD，仅适用于杠杆/交割/永续/期权</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	InstID</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;instId&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // BTC-USDT   BTC-USDT-SWAP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	InstType</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;instType&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 产品类型  SPOT 或者 SWAP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Lever</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;lever&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 支持的最大杠杆倍率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	ListTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;listTime&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 上架时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	LotSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;lotSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 最小下单数量 合约为 张数，现货则为 交易品数量 如 BTC 数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxIcebergSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxIcebergSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 冰山委托的单笔最大委托数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxLmtSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxLmtSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 限价单最大委托数量  合约的数量单位是张，现货的数量单位是USDT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxMktSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxMktSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 市价单的单笔最大委托数量  合约的数量单位是张，现货的数量单位是USDT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxStopSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxStopSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // 止盈止损市价委托的单笔最大委托数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxTriggerSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxTriggerSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 计划委托委托的单笔最大委托数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MaxTwapSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;maxTwapSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // 时间加权单的单笔最大委托数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	MinSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;minSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 最小下单数量 合约的数量单位是张，现货的数量单位是交易货币</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	QuoteCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;quoteCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 计价货币币种，如 BTC-USDT 中的USDT ，仅适用于币币交易</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	SettleCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;settleCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">    // 结算币种 ，如 USDT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	State</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;state&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 产品状态 live ：交易中 ，其余状态将被过滤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	TickSz</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;tickSz&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">       // 下单价格精度 如 0.0001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Uly</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">          string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;uly&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">          // 标的指数，如 BTC-USD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>其余具体详细可查看源码。</p></blockquote><p><strong>榜单数据</strong></p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> TickerType</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	GoodsId</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;GoodsId&quot;\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Okx_InstID</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Okx_InstID&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // 欧意的主键</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Binance_Symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Binance_Symbol&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 币安的主键</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BaseCcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;BaseCcy&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 币种名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	State</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">          string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;State&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">          // 交易品现货状态，默认；live OKX 现货，币安 现货 ，OKX 合约 有一家状态不对 则为 warning</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Last</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">           string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Last&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">           // 最新成交价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Open24H</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Open24H&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 24小时开盘价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	High24H</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;High24H&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        // 最高价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Low24H</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">         string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Low24H&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">         // 最低价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	OKXVol24H</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">      string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;OKXVol24H&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">      // OKX 24小时成交量 USDT 数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BinanceVol24H</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;BinanceVol24H&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">  // Binance 24 小时成交 USDT 数量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	U_R24</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">          string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;U_R24&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">          // 涨幅 = (最新价-开盘价)/开盘价</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	Volume</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">         string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;Volume&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">         // 成交量总和</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	OkxVolRose</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">     string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;OkxVolRose&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">     // 欧意占比总交易量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	BinanceVolRose</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;BinanceVolRose&quot;\`</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // 币安占比总交易量</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	TimeUnix</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">       int64</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  \`json:&quot;TimeUnix&quot;\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">	TimeStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        string</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`json:&quot;TimeStr&quot;\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>K 线</strong></p><blockquote><p>因为 K 线的数据量体积比较大，所以最好的就是这种精巧的方式进行存储和传输</p></blockquote><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;">  okx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">o</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">l</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">v</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">q</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">//时间戳，开盘价，最高价，最低价，收盘价，成交量，成交额</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    [</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">o</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">h</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">l</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">v</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">q</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#E06C75;">  binance</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:[],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对应的 go 结构体如下</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> KlineSimpType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> // TimeUnix,O,H,L,C,V,Q</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> KlineExchangeMap</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">][]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">KlineSimpType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;okx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> : []</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">KlineSimpType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  &quot;binance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> : []</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">KlineSimpType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解析方式</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> fetchData</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;xxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> KlineMap</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> KlineExchangeMap</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">jsoniter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Unmarshal</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fetchData</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">KlineMap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> okxKline</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> KlineMap</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;okx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> k</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> , </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> okxKline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  kItem</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;"> :=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">KlineType</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    TimeStr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    O</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    H</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    L</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    C</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    V</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    Q</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:        </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="程序架构图" tabindex="-1"><a class="header-anchor" href="#程序架构图"><span>程序架构图</span></a></h2><figure><img src="`+t+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="性能实测" tabindex="-1"><a class="header-anchor" href="#性能实测"><span>性能实测</span></a></h2><p>清除掉本地所有的数据，第一次获取 okx 和 币安 320 条 <br> 也就是需要每个交易所需要请求 4 次，一共 8 次请求，数据拼接整理并返回，加上本地网络共耗时 <code>3685毫秒</code>。 <br> 第二次获取相同的数据，直接从本地读取，耗时 <code>2毫秒</code>， 也就是同样的数据一口气读取上万条本地耗时不会超过 <code>70毫秒</code> <br> 【实测，曾经写一款小时版本的策略，一年数据量 8700 条，本地 MongoDB 读取耗时 283 毫秒 】 <br> 而且这种 <code>无需索引直接通过算法直达的</code> 实现方式不会因为 文件数量的增多而增加查询耗时，其性能完全碾压各大数据库。 并且使用和部署方式以及环境依赖都极为简单。</p><blockquote><p>当然，这是针对 K 线 这种特殊结构专门设计的。 通用型数据还是数据库更合适。</p></blockquote><figure><img src="'+l+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>实测，一个文件占据空为 12kb; 无论是任何间隔的 K 线数据其一个文件体积都是一样的。<br> 一个币种，一年的文件总数为 : <code>88 + 176 + 351 + 1052 + 5257 = 6924</code> 按照 7000 来算<br><code>12 * 7000 = 84000 KB</code> 也就是说，一个币种一个交易所一年占用的存储空间约为 0.08 GB <br> 一个交易所有效的交易币种不超过 200 ，一个交易所一年全部币种的数据全部进行本地存储 占据 16GB 空间 也就是一台硬盘空间 <code>240 GB</code> 的服务器就能存下两个交易所 6 年积累的全部 K 线数据。</p></blockquote><h2 id="程序设计思路" tabindex="-1"><a class="header-anchor" href="#程序设计思路"><span>程序设计思路</span></a></h2><p>因为是 根据 K 线的特点，基于本地文件专门设计的读写和寻址方式 ，所以即用即走，效率非常高，也非常轻量化，需要经常用到的数据就进行内存缓存。</p><p>无需 redis，无需数据库。</p><p>一开始是打算设计成独立服务去单独部署的，但是因为提供给用户使用的是 open-api ，无论怎么实现都需要 http 包一层。于是就设计成了 SDK 的方式。 而且，将来开发 VSCode 插件时 也需要用到这个模块，SDK 的实现方式则更加灵活和便捷。</p><h2 id="服务器分布式部署思路" tabindex="-1"><a class="header-anchor" href="#服务器分布式部署思路"><span>服务器分布式部署思路</span></a></h2><p>可以罗列一份规则清单和转发地址 ，关于交易所 A 的请求转发到 服务器 A；关于币种 a-z 的可以转发到服务器 B；关于时间范围为 C 的转发到服务器 C .... <br> 因为本地文件碎片化的属性，所以分布式部署除了增加转发时额外的网络 i/o 之外，其效率并未有差别，但是可以支持更多的高并发和存储空间。将来想要扩充交易所或者是 K 线类型可以说都非常容易且无缝衔接。</p><p>如果提前计算好，还能充分利用各个服务器冗余的资源和空间。</p><h2 id="数据的迁移-和-代理请求" tabindex="-1"><a class="header-anchor" href="#数据的迁移-和-代理请求"><span>数据的迁移 和 代理请求</span></a></h2><p>在系统初始化时，设置好 <code>DataPath</code> ， 程序会自动接管该目录，并在请求来临时检查对应所需文件的完整性，数据不完整则会去交易所拿取最新数据并覆盖，如果数据完整，则会直接读取并返回。</p><p>同一台机器也可以同时初始化多份程序，多个不同的数据目录同时进行读写。</p><p>程序会自动补全缺失的文件： 若一次请求 时间跨度超过了 4 个文件，其中三个文件本地有，则只会去交易所请求那一个没有的文件，其余文件直接读取返回。</p><p>迁移数据只需要迁移对应的目录即可。</p><p><strong>请求代理 IP 池的设定：</strong> 程序初始化允许填写多个代理 ip 地址，它会随机使用其中可用的 IP 发出请求，以避免触发交易所的 IP 频率限制。同时也方便了国内用户家用电脑的本地数据调试。</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 初始化项目配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SysInit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">SysInitOpt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  LogPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:   </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 日志文件存放目录，缺省值：./logs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  DataPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:  </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,                                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 数据文件存放目录，缺省值：./data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  ProxyURLs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: []</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://127.0.0.1:10809&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// 在拉取交易所数据时使用的代理池,没有代理则直接向交易所发起请求，国内可能会失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,47),e=[k];function p(r,d){return a(),s("div",null,e)}const o=i(h,[["render",p],["__file","coin-candle.html.vue"]]),c=JSON.parse('{"path":"/open-api/coin-candle.html","title":"1. 市场模块coin-candle","lang":"zh-CN","frontmatter":{"category":["OpenApi"],"tag":["OpenApi"],"permalink":"/open-api/coin-candle.html","description":"1. 市场模块coin-candle 仓库地址: https://github.com/otter-trade/coin-candle 要解决的问题： 国内获取数据需要科学上网 交易所请求规范和行为不统一，解析方式也不统一，请求参数也比较繁琐 回测时对 K 线的消耗比较大，但是频繁去交易所获取效率太慢 需要用到 K 线模块的服务太多了 其实团队内小伙伴...","head":[["meta",{"property":"og:url","content":"https://doc.OtterTrade.com/open-api/coin-candle.html"}],["meta",{"property":"og:site_name","content":"OtterTrade"}],["meta",{"property":"og:title","content":"1. 市场模块coin-candle"}],["meta",{"property":"og:description","content":"1. 市场模块coin-candle 仓库地址: https://github.com/otter-trade/coin-candle 要解决的问题： 国内获取数据需要科学上网 交易所请求规范和行为不统一，解析方式也不统一，请求参数也比较繁琐 回测时对 K 线的消耗比较大，但是频繁去交易所获取效率太慢 需要用到 K 线模块的服务太多了 其实团队内小伙伴..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-25T10:12:19.000Z"}],["meta",{"property":"article:author","content":"OtterTrade"}],["meta",{"property":"article:tag","content":"OpenApi"}],["meta",{"property":"article:modified_time","content":"2024-06-25T10:12:19.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"1. 市场模块coin-candle\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-25T10:12:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"OtterTrade\\",\\"url\\":\\"https://OtterTrade.com\\"}]}"],["link",{"rel":"alternate","type":"application/atom+xml","href":"https://doc.OtterTrade.com/atom.xml","title":"OtterTrade Atom Feed"}],["link",{"rel":"alternate","type":"application/json","href":"https://doc.OtterTrade.com/feed.json","title":"OtterTrade JSON Feed"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://doc.OtterTrade.com/rss.xml","title":"OtterTrade RSS Feed"}]]},"headers":[{"level":2,"title":"安装方式","slug":"安装方式","link":"#安装方式","children":[]},{"level":2,"title":"代码示例","slug":"代码示例","link":"#代码示例","children":[]},{"level":2,"title":"数据结构示意","slug":"数据结构示意","link":"#数据结构示意","children":[]},{"level":2,"title":"程序架构图","slug":"程序架构图","link":"#程序架构图","children":[]},{"level":2,"title":"性能实测","slug":"性能实测","link":"#性能实测","children":[]},{"level":2,"title":"程序设计思路","slug":"程序设计思路","link":"#程序设计思路","children":[]},{"level":2,"title":"服务器分布式部署思路","slug":"服务器分布式部署思路","link":"#服务器分布式部署思路","children":[]},{"level":2,"title":"数据的迁移 和 代理请求","slug":"数据的迁移-和-代理请求","link":"#数据的迁移-和-代理请求","children":[]}],"git":{"createdTime":1719297463000,"updatedTime":1719310339000,"contributors":[{"name":"mo7","email":"mo7@mo7.cc","commits":8}]},"readingTime":{"minutes":8.15,"words":2446},"filePathRelative":"open-api/1.coin-candle.md","localizedDate":"2024年6月25日","autoDesc":true,"excerpt":"\\n<p>仓库地址: <a href=\\"https://github.com/otter-trade/coin-candle\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://github.com/otter-trade/coin-candle</a></p>\\n<p>要解决的问题：</p>\\n<ol>\\n<li>国内获取数据需要<code>科学上网</code></li>\\n<li>交易所请求规范和行为不统一，解析方式也不统一，请求参数也比较繁琐</li>\\n<li>回测时对 K 线的消耗比较大，但是频繁去交易所获取效率太慢</li>\\n<li>需要用到 K 线模块的服务太多了</li>\\n</ol>"}');export{o as comp,c as data};
